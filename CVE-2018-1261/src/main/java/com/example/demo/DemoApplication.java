package com.example.demo;

import org.springframework.core.io.DefaultResourceLoader;
import org.springframework.core.io.Resource;
import org.springframework.core.io.ResourceLoader;
import org.springframework.integration.support.MessageBuilder;
import org.springframework.messaging.Message;

import java.io.File;
import java.io.InputStream;

//import org.springframework.boot.SpringApplication;
//import org.springframework.boot.autoconfigure.SpringBootApplication;
//
//@SpringBootApplication
public class DemoApplication {

//	public static void main(String[] args) {
//		SpringApplication.run(DemoApplication.class, args);
//	}

	public static void main(String[] args) {
		ResourceLoader resourceLoader = new DefaultResourceLoader();
		File path =  new File("./targetFolder/");
		final Resource evilResource = resourceLoader.getResource("classpath:test.zip");
		try{
			InputStream evilIS = evilResource.getInputStream();
			Message<InputStream> evilMessage = MessageBuilder.withPayload(evilIS).build();
			UnZipTransformer unZipTransformer = new UnZipTransformer();
			unZipTransformer.setWorkDirectory(path);
			unZipTransformer.afterPropertiesSet();
			unZipTransformer.transform(evilMessage);
		}catch (Exception e){
			System.out.println(e);
		}
	}
}
